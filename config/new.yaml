# copyè‡ªhttps://gist.github.com/meooxx/5d6e17e186adec975e0ae2b8a577de59
# æœ‰æ—¶é—´ç ”ç©¶ä¸€ä¸‹
# 1 åªéœ€è¦ä¿®æ”¹ proxy-providers, å°†è®¢é˜…é…ç½®åˆ° provider1 è¿™æ ·çš„åˆ†ç»„é‡Œé¢, æ·»åŠ ä¸€ä¸ªè‡ªå®šä¹‰åç¼€, ç”¨äºé˜²æ­¢åŒä¸€ä¸ªæœºåœºä¸‹ä¸åŒåè®®,
# èŠ‚ç‚¹åç§°å´ç›¸åŒå¯¼è‡´çš„è¦†ç›–. åŒä¸€æœºåœºä¸‹å¦‚ trojan è®¢é˜…å’Œ vless è®¢é˜… èŠ‚ç‚¹åç§°ç›¸åŒ, æ­¤æ—¶ä¸åŠ åç¼€, ä¼šè¢«è¦†ç›–
# åŒç†æ·»åŠ ç¬¬äºŒ, ç¬¬ä¸‰ä¸ªè®¢é˜…åªéœ€å¤åˆ¶ provider1, ä¿®æ”¹ä¸º provider2 å’Œå…¶å¯¹åº” url å’Œ additional-suffix å­—æ®µ

# 2 æ”¯æŒè‡ªå»ºèŠ‚ç‚¹, å¯å°†è‡ªå»ºèŠ‚ç‚¹é“¾æ¥æ·»åŠ åˆ° myown, urlä¸­, myown åå­—æœ€å¥½ä¸è¦æ›´æ”¹, æˆ–è€…åŒæ—¶ä¿®æ”¹å¼•ç”¨çš„åœ°æ–¹å¦‚ chainProxy
# 3 å¦å¤–æ³¨é‡Šäº†ä¸€ä¸ªé“¾å¼ä»£ç†é…ç½®, å¯æŒ‰éœ€é…é…. æ€è·¯æ˜¯å°†éœ€è¦é“¾å¼ä»£ç†çš„è®¢é˜…å•ç‹¬é…ç½®ä¸€ä¸ª provider, ç„¶ååœ¨åˆ†ç»„é‚£é‡Œä½¿ç”¨ use å­—æ®µè·å–è¯¥åˆ†ç»„ä¸‹èŠ‚ç‚¹, å¹¶ä½¿ç”¨ override
# æ·»åŠ  dialer-proxy å­—æ®µ
# 4 ä¿®æ”¹å®Œæˆå, åœ¨clash å®¢æˆ·ç«¯å¯¼å…¥è¯¥é…ç½®


proxy-providers:
  provider1:
    url: 'è¿™é‡Œè®¢é˜…é“¾æ¥'
    type: http
    interval: 1440
    health-check:
      enable: true
      url: https://www.gstatic.com/generate_204
      interval: 300
    proxy: DIRECT
    override: { additional-suffix: '-p1' } #ä¿®æ”¹è‡ªå®šåç¼€

  # provider2:
  #   url: 'è¿™é‡Œè®¢é˜…é“¾æ¥'
  #   type: http
  #   interval: 1440
  #   health-check:
  #     enable: true
  #     url: https://www.gstatic.com/generate_204
  #     interval: 300
  #   proxy: DIRECT
  #   override: { additional-suffix: '-p2' } # ä¿®æ”¹åç¼€

  # è‡ªå»ºè®¢é˜…, æœ€å¥½åªæ”¹url
  myown:
    url: 'è¿™é‡Œè®¢é˜…é“¾æ¥'
    type: http
    interval: 1440
    health-check:
      enable: true
      url: https://www.gstatic.com/generate_204
      interval: 300
    proxy: DIRECT
    override: { additional-suffix: 'ğŸƒ' }

  # chainProxy:
  # url: ''
  # type: http
  # interval: 1440
  # health-check:
  #   enable: true
  #   url: https://www.gstatic.com/generate_204
  #   interval: 300
  # proxy: ğŸš€ é»˜è®¤ä»£ç†
  # override: { additional-suffix: 'ğŸ”—', dialer-proxy: ğŸš€ é»˜è®¤ä»£ç† }
  # payload: [{ <<: *globalDirect }]

# å…¨å±€é…ç½®
port: 7890
socks-port: 7891
redir-port: 7892
mixed-port: 7893
tproxy-port: 7894
allow-lan: false
unified-delay: true
# interface-name: en0
global-client-fingerprint: chrome
ipv6: true

external-controller-cors:
  allow-private-network: true
  allow-origins:
    - tauri://localhost
    - http://tauri.localhost
    - https://superq.site

secret: asdf123
profile:
  store-selected: true
  store-fake-ip: true
tun:
  route-exclude-address:
    - 100.64.0.0/10
    - fd7a:115c:a1e0::/48
  auto-detect-interface: true
  auto-route: true
  device: Mihomo
  dns-hijack:
    - any:53
  mtu: 1500
  stack: gvisor
  strict-route: false
  enable: true
  
# DNSæ¨¡å—
dns:
  # ç”¨äºæŸ¥è¯¢ doh
  default-nameserver:
    - system
    - 119.29.29.29
    - 223.6.6.6
  ipv6: true
  enable: true
  prefer-h3: true
  enhanced-mode: fake-ip
  fake-ip-filter-mode: blacklist
  fake-ip-filter:
    - '*.lan'
    - '*.local'
    - '*.arpa'
    - time.*.com
    - ntp.*.com
    - time.*.com
    - +.market.xiaomi.com
    - localhost.ptlogin2.qq.com
    - '*.msftncsi.com'
    - www.msftconnecttest.com
  fallback-filter:
    domain:
      - +.google.com
      - +.facebook.com
      - +.youtube.com
    geoip: true
    geoip-code: CN
    ipcidr:
      - 240.0.0.0/4
      - 0.0.0.0/32
  fake-ip-range: 198.18.0.1/16
  # æŒ‡å®š tailscale ç½‘æ®µæŒ‡å®šæœ¬åœ° quad100 è§£æ
  nameserver-police:
    +.tail2984f4.ts.net: 100.100.100.100
  # é»˜è®¤dnsè§£ææœåŠ¡, è§£æè§„åˆ™åŒ¹é… ip å’Œ å›½å†…çš„åŸŸå
  nameserver:
    - https://doh.pub/dns-query
    - https://dns.alidns.com/dns-query
    # - 8.8.8.8
  # ä»£ç†æœåŠ¡å™¨åŸŸåè§£æ
  proxy-server-nameserver:
    - https://doh.pub/dns-query
    - https://dns.alidns.com/dns-query
# alias å’Œ anchor
global-direct: &globalDirect { name: ğŸ¯ å…¨çƒç›´è¿, type: direct }
group_select_proxy: &groupSelectProxy { type: select, proxies: [
        ğŸš€ é»˜è®¤ä»£ç†,
        ğŸ”¯ é¦™æ¸¯æ•…è½¬,
        ğŸ”¯ æ—¥æœ¬æ•…è½¬,
        â™»ï¸ é¦™æ¸¯è‡ªåŠ¨,
        â™»ï¸ æ—¥æœ¬è‡ªåŠ¨,
        â™»ï¸ AIä¸œå—äºšè‡ªåŠ¨,
        â™»ï¸ ç¾å›½è‡ªåŠ¨,
        â™»ï¸ è‡ªåŠ¨é€‰æ‹©,
        ğŸƒ è‡ªå»ºèŠ‚ç‚¹,
        # ğŸ”— é“¾å¼ä»£ç†,
        ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹,
        ğŸ§‹ å°æ¹¾,
        ğŸ¥¥ ä¸œå—äºš,
        ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹,
        ğŸ‡ºğŸ‡² ç¾å›½èŠ‚ç‚¹,
        ğŸŒ å…¨éƒ¨èŠ‚ç‚¹,
        ğŸ¯ å…¨çƒç›´è¿
      ] }
group_select_direct: &groupSelectDirect { type: select, proxies: [
        ğŸ¯ å…¨çƒç›´è¿,
        ğŸš€ é»˜è®¤ä»£ç†,
        ğŸ”¯ é¦™æ¸¯æ•…è½¬,
        ğŸ”¯ æ—¥æœ¬æ•…è½¬,
        â™»ï¸ é¦™æ¸¯è‡ªåŠ¨,
        â™»ï¸ æ—¥æœ¬è‡ªåŠ¨,
        â™»ï¸ AIä¸œå—äºšè‡ªåŠ¨,
        â™»ï¸ ç¾å›½è‡ªåŠ¨,
        â™»ï¸ è‡ªåŠ¨é€‰æ‹©,
        ğŸƒ è‡ªå»ºèŠ‚ç‚¹,
        # ğŸ”— é“¾å¼ä»£ç†,
        ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹,
        ğŸ§‹ å°æ¹¾,
        ğŸ¥¥ ä¸œå—äºš,
        ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹,
        ğŸ‡ºğŸ‡² ç¾å›½èŠ‚ç‚¹,
        ğŸŒ å…¨éƒ¨èŠ‚ç‚¹
      ] }

# åˆå§‹èŠ‚ç‚¹ä¿¡æ¯
proxies:
  - { <<: *globalDirect }
  - {
      name: ğŸ  å†…ç½‘ä»£ç†,
      type: socks5,
      server: 127.0.0.1,
      port: 1080,
      udp: true
    }

proxy-groups:
  - { name: ğŸš€ é»˜è®¤ä»£ç†, type: select, proxies: [
          ğŸ”¯ é¦™æ¸¯æ•…è½¬,
          ğŸ”¯ æ—¥æœ¬æ•…è½¬,
          â™»ï¸ é¦™æ¸¯è‡ªåŠ¨,
          â™»ï¸ æ—¥æœ¬è‡ªåŠ¨,
          â™»ï¸ AIä¸œå—äºšè‡ªåŠ¨,
          â™»ï¸ ç¾å›½è‡ªåŠ¨,
          â™»ï¸ è‡ªåŠ¨é€‰æ‹©,
          ğŸƒ è‡ªå»ºèŠ‚ç‚¹,
          # ğŸ”— é“¾å¼ä»£ç†,
          ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹,
          ğŸ§‹ å°æ¹¾,
          ğŸ¥¥ ä¸œå—äºš,
          ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹,
          ğŸ‡ºğŸ‡² ç¾å›½èŠ‚ç‚¹,
          ğŸŒ å…¨éƒ¨èŠ‚ç‚¹
        ] }
  - { name: ğŸŒˆ tailscale, type: select, proxies: [DIRECT, ğŸ  å†…ç½‘ä»£ç†] }

  - { name: ğŸŒ å…¨éƒ¨èŠ‚ç‚¹, type: select, include-all: true }
  - { name: ğŸƒ è‡ªå»ºèŠ‚ç‚¹, type: select, use: [myown] }
  # - { name: ğŸ”— é“¾å¼ä»£ç†, type: select, use: [chainProxy] }
  - { name: ğŸ”´ YouTube, <<: *groupSelectProxy }
  - { name: ğŸ¤– AI, <<: *groupSelectProxy }
  - { name: </> GitHub, <<: *groupSelectProxy }
  - { name: â“‚ï¸ Microsoft, <<: *groupSelectDirect }
  - { name: ğŸ•º TikTok, <<: *groupSelectProxy }
  - { name: ğŸ“² Telegram, <<: *groupSelectProxy }
  - { name: ğŸ¿ NETFLIX, <<: *groupSelectProxy }
  - { name: âš¡ Speedtest, <<: *groupSelectDirect }
  - { name: ğŸ’¸ PayPal, <<: *groupSelectProxy }
  - { name: ğŸ® Game, <<: *groupSelectDirect }
  - { name: ï£¿_ Apple, <<: *groupSelectDirect }

  - {
      name: ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹,
      type: select,
      include-all: true,
      filter: '(?i)æ¸¯|hk|hongkong|hong kong'
    }
  - {
      name: ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹,
      type: select,
      include-all: true,
      filter: '(?i)æ—¥|jp|japan'
    }
  - {
      name: ğŸ¥¥ ä¸œå—äºš,
      type: select,
      include-all: true,
      filter: '(?i)æ–°|singapore|sg|malaysia|singapore|é©¬æ¥'
    }
  - {
      name: â™»ï¸ AIä¸œå—äºšè‡ªåŠ¨,
      type: url-test,
      include-all: true,
      tolerance: 20,
      interval: 300,
      filter: '(?i)æ–°|singapore|sg|malaysia|singapore|é©¬æ¥'
    }
  - {
      name: ğŸ§‹ å°æ¹¾,
      type: select,
      include-all: true,
      filter: '(?i)å°|tw|taiwan'
    }
  - {
      name: ğŸ‡ºğŸ‡² ç¾å›½èŠ‚ç‚¹,
      type: select,
      include-all: true,
      filter: '(?i)ç¾|us|unitedstates|united states'
    }
  - {
      name: ğŸ”¯ é¦™æ¸¯æ•…è½¬,
      type: fallback,
      include-all: true,
      tolerance: 20,
      interval: 300,
      filter: '(?=.*(æ¸¯|HK|(?i)Hong))^((?!(å°|æ—¥|éŸ©|æ–°|æ·±|ç¾)).)*$'
    }
  - {
      name: ğŸ”¯ æ—¥æœ¬æ•…è½¬,
      type: fallback,
      include-all: true,
      tolerance: 20,
      interval: 300,
      filter: '(?=.*(æ—¥|JP|(?i)Japan))^((?!(æ¸¯|å°|éŸ©|æ–°|ç¾)).)*$'
    }
  - {
      name: â™»ï¸ é¦™æ¸¯è‡ªåŠ¨,
      type: url-test,
      include-all: true,
      tolerance: 20,
      interval: 300,
      filter: '(?=.*(æ¸¯|HK|(?i)Hong))^((?!(å°|æ—¥|éŸ©|æ–°|æ·±|ç¾)).)*$'
    }
  - {
      name: â™»ï¸ æ—¥æœ¬è‡ªåŠ¨,
      type: url-test,
      include-all: true,
      tolerance: 20,
      interval: 300,
      filter: '(?=.*(æ—¥|JP|(?i)Japan))^((?!(æ¸¯|å°|éŸ©|æ–°|ç¾)).)*$'
    }
  - {
      name: â™»ï¸ ç¾å›½è‡ªåŠ¨,
      type: url-test,
      include-all: true,
      tolerance: 20,
      interval: 300,
      filter: '(?=.*(ç¾|US|(?i)States|America))^((?!(æ¸¯|å°|æ—¥|éŸ©|æ–°)).)*$'
    }
  - {
      name: â™»ï¸ è‡ªåŠ¨é€‰æ‹©,
      type: url-test,
      include-all: true,
      tolerance: 20,
      interval: 300,
      exclude-filter: 'ç›´è¿|å†…ç½‘'
    }
  - { name: ğŸŸ æ¼ç½‘ä¹‹é±¼, <<: *groupSelectProxy }
  - name: ğŸ›‘ å¹¿å‘Šæ‹¦æˆª
    type: select
    proxies:
      - REJECT
      - DIRECT
# è§„åˆ™åŒ¹é…
# æ­¤è§„åˆ™éƒ¨åˆ†æ²¡æœ‰åšé˜²æ³„éœ²å¤„ç†ï¼Œå› ä¸ºå¼Šä¸¥é‡å¤§äºåˆ©ï¼
rules:
  # tailscale å†…ç½‘ç©¿é€è§„åˆ™, å¿…é¡» no-resolve å¦åˆ™ä¼šä½¿ç”¨ nameserver dns æŸ¥è¯¢
  - IP-CIDR,10.100.0.0/16,ğŸŒˆ tailscale,no-resolve
  - DOMAIN-SUFFIX,tail2984f4.ts.net,ğŸŒˆ tailscale
  - DOMAIN-SUFFIX,ts.net,ğŸŒˆ tailscale

  - RULE-SET,private_domain,ğŸ¯ å…¨çƒç›´è¿
  - RULE-SET,cn_domain,ğŸ¯ å…¨çƒç›´è¿
  - RULE-SET,ad,ğŸ›‘ å¹¿å‘Šæ‹¦æˆª
  - RULE-SET,apple_domain,ï£¿_ Apple
  - RULE-SET,ai,ğŸ¤– AI
  - RULE-SET,youtube_domain,ğŸ”´ YouTube
  - RULE-SET,google_domain,ğŸš€ é»˜è®¤ä»£ç†
  - RULE-SET,github_domain,</> GitHub
  - GEOSITE,apple,ï£¿_ Apple

  - RULE-SET,microsoft_domain,â“‚ï¸ Microsoft
  - RULE-SET,tiktok_domain,ğŸ•º TikTok
  - RULE-SET,speedtest_domain,âš¡ Speedtest
  - RULE-SET,telegram_domain,ğŸ“² Telegram
  - RULE-SET,netflix_domain,ğŸ¿ NETFLIX
  - RULE-SET,paypal_domain,ğŸ’¸ PayPal
  - RULE-SET,game,ğŸ® Game
  - RULE-SET,gfw_domain,ğŸš€ é»˜è®¤ä»£ç†
  - RULE-SET,geolocation-!cn,ğŸš€ é»˜è®¤ä»£ç†
  - RULE-SET,google_ip,ğŸš€ é»˜è®¤ä»£ç†,no-resolve
  - RULE-SET,netflix_ip,ğŸ¿ NETFLIX,no-resolve
  - RULE-SET,telegram_ip,ğŸ“² Telegram,no-resolve
  - RULE-SET,cn_ip,ğŸ¯ å…¨çƒç›´è¿,no-resolve
  - MATCH,ğŸŸ æ¼ç½‘ä¹‹é±¼

# è§„åˆ™é›†
rule-anchor:
  ip: &ip { type: http, interval: 86400, behavior: ipcidr, format: mrs }
  domain: &domain { type: http, interval: 86400, behavior: domain, format: mrs }
  class:
    &class { type: http, interval: 86400, behavior: classical, format: text }
rule-providers:
  private_domain:
    {
      <<: *domain,
      url: 'https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/private.mrs'
    }
  ai:
    {
      <<: *domain,
      url: 'https://github.com/MetaCubeX/meta-rules-dat/raw/refs/heads/meta/geo/geosite/category-ai-!cn.mrs'
    }
  youtube_domain:
    {
      <<: *domain,
      url: 'https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/youtube.mrs'
    }

  github_domain:
    {
      <<: *domain,
      url: 'https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/github.mrs'
    }
  telegram_domain:
    {
      <<: *domain,
      url: 'https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/telegram.mrs'
    }
  netflix_domain:
    {
      <<: *domain,
      url: 'https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/netflix.mrs'
    }
  paypal_domain:
    {
      <<: *domain,
      url: 'https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/paypal.mrs'
    }

  microsoft_domain:
    {
      <<: *domain,
      url: 'https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/microsoft.mrs'
    }
  apple_domain:
    {
      <<: *domain,
      url: 'https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/apple-cn.mrs'
    }
  speedtest_domain:
    {
      <<: *domain,
      url: 'https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/ookla-speedtest.mrs'
    }
  tiktok_domain:
    {
      <<: *domain,
      url: 'https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/tiktok.mrs'
    }
  gfw_domain:
    {
      <<: *domain,
      url: 'https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/gfw.mrs'
    }
  geolocation-!cn:
    {
      <<: *domain,
      url: 'https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/geolocation-!cn.mrs'
    }
  cn_domain:
    {
      <<: *domain,
      url: 'https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/cn.mrs'
    }

  cn_ip:
    {
      <<: *ip,
      url: 'https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/cn.mrs'
    }
  google_ip:
    {
      <<: *ip,
      url: 'https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/google.mrs'
    }
  google_domain:
    {
      <<: *domain,
      url: 'https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/google.mrs'
    }
  telegram_ip:
    {
      <<: *ip,
      url: 'https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/telegram.mrs'
    }
  netflix_ip:
    {
      <<: *ip,
      url: 'https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/netflix.mrs'
    }
  game:
    {
      <<: *domain,
      url: 'https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/category-games-!cn.mrs'
    }
  ad:
    {
      <<: *domain,
      url: 'https://raw.githubusercontent.com/privacy-protection-tools/anti-ad.github.io/master/docs/mihomo.mrs'
    }
